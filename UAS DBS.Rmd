---
title: "Flex Dashboards"
output: 
  flexdashboard::flex_dashboard:
    vertical_layout: scroll
    theme: united
    source_code: embed
---

```{r setup, include=FALSE}
# Importing libraries
library(flexdashboard)
library(tidyverse)
library(highcharter)
library(gt)
library(htmltools)
library(viridis)
library(DT)
```


```{r, include = FALSE}
# Importing data
orders<- read.csv('Orders.csv')
product = read.csv('Products.csv')
employee = read.csv('Employees.csv')
Cust = read.csv('Customers.csv')
ship = read.csv('Shippers.csv')
orderdets = read.csv('OrderDetails.csv')
supp = read.csv('Suppliers.csv')
cat = read.csv('Categories.csv')

```
 

Bar-chart {data-orientation=columns}
=======================================================================


## Row 
-----------------------------------------------------------------------

### Sales By Country {data-width=1440}

```{r, include = FALSE}

df2 <- merge(x=orders,y=orderdets, 
             by="OrderID")
df2a = merge(df2, Cust, by='CustomerID')
df2b = merge(df2a, product, by='ProductID')
df2b$TotalOrder = df2b$Quantity*df2b$Price

```

```{r}
# Colors
custom_colors <- viridis::plasma(n = 21)

# Most popular authors by reviews
df2b %>% 
  group_by(Country) %>% 
  summarise(TotalOrder= sum(TotalOrder)) %>% 
  arrange(desc(TotalOrder)) %>% 
  head(21) %>% 
  hchart('column', hcaes(x = Country, y =TotalOrder ,color = custom_colors)) %>%   hc_add_theme(hc_theme_google()) %>% 
  hc_tooltip(pointFormat = '<b>Number of Sales: </b> {point.y} <br>') %>% 
  hc_title(text = 'Total Sales by Country',
           style = list(fontSize = '25px', fontWeight = 'bold')) %>% 
  hc_subtitle(text = 'Sort By Descending',
              style = list(fontSize = '16px')) %>% 
  hc_credits(enabled = TRUE, text = '@stroberi')
```

### Sales Movement {data-width=1440}

```{r}
df2b$OrderDate = as.Date(df2b$OrderDate)

library(tidyverse)
colors <- viridis::magma(n = 8)

#group data by month and sum sales
df2b %>% 
    group_by(month = lubridate::floor_date(OrderDate, 'month')) %>%
    summarize(TotalRevenue = sum(TotalOrder)) %>% 

  head(8) %>% 
  hchart('line', hcaes(x = month, y =TotalRevenue ,color = colors)) %>%   hc_add_theme(hc_theme_google()) %>% 
  hc_tooltip(pointFormat = '<b>Number of Sales: </b> {point.y} <br>') %>% 
  hc_title(text = 'Total Sales by Month',
           style = list(fontSize = '25px', fontWeight = 'bold')) %>% 
  hc_subtitle(text = 'Visualized in A Line',
              style = list(fontSize = '16px')) %>% 
  hc_credits(enabled = TRUE, text = '@stroberi')

```